# История ввода и вывода
IPython позволяет получать доступ к предыдущим командам с помощью клавиш со стрелками вверх и вниз или сочетаний клавиш Ctrl-p/Ctrl-n.
# Объекты входа и выхода IPython
Я полагаю, что к настоящему моменту вы уже знакомы со стилем приглашений `In [1]:`/`Out[1]:`, используемым в IPython.
Но оказывается, что это не просто красивое украшение: они дают подсказку о том, как получить доступ к предыдущим входам и выходам в текущем сеансе.
Предположим, мы начинаем сеанс, который выглядит следующим образом:
```ipython
In [1]: import math

In [2]: math.sin(2)
Out[2]: 0.9092974268256817

In [3]: math.cos(2)
Out[3]: -0.4161468365471424
```
Мы импортировали встроенный пакет `math`, затем вычислили синус и косинус числа 2.
Эти входы и выходы отображаются в оболочке с метками `In`/`Out`, но это еще не все — IPython на самом деле создает некоторые переменные Python с именами `In` и `Out`, которые автоматически обновляются для отражения этой истории:
```ipython
In [4]: In
Out[4]: ['', 'import math', 'math.sin(2)', 'math.cos(2)', 'In']

In [5]: Out
Out[5]:
{2: 0.9092974268256817,
 3: -0.4161468365471424,
 4: ['', 'import math', 'math.sin(2)', 'math.cos(2)', 'In', 'Out']}
```
Объект `In` представляет собой список, в котором команды отслеживаются по порядку (первый элемент в списке является заполнителем, поэтому `In [1]` может ссылаться на первую команду):
```ipython
В [6]: печать(В[1])
импорт математики
```
Объект `Out` — это не список, а словарь, сопоставляющий входные числа с их выходами (если таковые имеются):
```ipython
В [7]: print(Out[2])
0,9092974268256817
```
Обратите внимание, что не все операции имеют выходные данные: например, операторы `import` и `print` не влияют на выходные данные.
Последнее может показаться удивительным, но имеет смысл, если учесть, что `print` — это функция, которая возвращает `None`; для краткости любая команда, которая возвращает `None`, не добавляется в `Out`.
Это может быть полезно, если вы хотите взаимодействовать с прошлыми результатами.
Например, давайте проверим сумму `sin(2) ** 2` и `cos(2) ** 2`, используя ранее вычисленные результаты:
```ipython
В [8]: Вышел[2] ** 2 + Вышел[3] ** 2
Выход[8]: 1.0
```
Результат равен «1,0», как и следовало ожидать из известного тригонометрического тождества.
В этом случае использование этих предыдущих результатов, вероятно, не является необходимым, но оно может оказаться весьма полезным, если вы выполняете очень затратное вычисление и забываете присвоить результат переменной.
## Подчеркивание сочетаний клавиш и предыдущие результаты
Стандартная оболочка Python содержит только один простой ярлык для доступа к предыдущему выводу: переменная `_` (т.е. один символ подчеркивания) обновляется с предыдущим выводом. Это работает и в IPython:
```ipython
В [9]: печать(_)
1.0
```
Но IPython идет немного дальше — вы можете использовать двойное подчеркивание для доступа к предпоследнему выводу и тройное подчеркивание для доступа к третьему с конца выводу (пропуская все команды без вывода):
```ipython
В [10]: печать(__)
-0,4161468365471424
В [11]: печать(___)
0,9092974268256817
```
На этом IPython останавливается: если символов подчеркивания больше трех, их становится сложно подсчитать, и в этом случае проще ссылаться на вывод по номеру строки.
Однако есть еще одно сокращение, о котором я должен упомянуть — сокращение для `Out[X]` — `_X` (т. е. одиночное подчеркивание, за которым следует номер строки):
```ipython
Вход [12]: Выход[2]
Выход[12]: 0,9092974268256817
В [13]: _2
Выход[13]: 0.9092974268256817
```
## Подавление вывода
Иногда вам может потребоваться подавить вывод оператора (возможно, это чаще всего встречается в командах построения графиков, которые мы рассмотрим в [Введении в Matplotlib](04.00-Introduction-To-Matplotlib.ipynb)).
Или, может быть, команда, которую вы выполняете, создает результат, который вы предпочли бы не сохранять в истории вывода, возможно, для того, чтобы его можно было освободить при удалении других ссылок.
Самый простой способ подавить вывод команды — добавить точку с запятой в конец строки:
```ipython
В [14]: math.sin(2) + math.cos(2);
```
Результат вычисляется молча, а вывод не отображается на экране и не сохраняется в словаре `Out`:
```ipython
В [15]: 14 вошел Вышел
Выход[15]: Ложь
```
## Связанные магические команды
Для доступа к пакету предыдущих входных данных одновременно очень полезна магическая команда `%history`.
Вот как можно распечатать первые четыре входных данных:
```ipython
В [16]: %history -n 1-3
   1: импорт математики
   2: математика.sin(2)
   3: математика.cos(2)
```
Как обычно, вы можете ввести `%history?` для получения дополнительной информации и описания доступных опций (подробности о функциональности `?` см. в [Справка и документация в IPython](01.01-Help-And-Documentation.ipynb)).
Другие полезные магические команды — это `%rerun`, которая повторно выполнит некоторую часть истории команд, и `%save`, которая сохраняет некоторую часть истории команд в файл.
